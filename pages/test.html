<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tambah Anggota dengan Gambar</title>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
    <!-- Tabel untuk menampilkan anggota -->
    <table class="table align-items-center mb-0" id="tabelAnggota">
      <thead class="bg-gray-100">
        <tr>
          <th class="text-secondary text-xs font-weight-semibold opacity-7">Anggota</th>
          <th class="text-secondary text-xs font-weight-semibold opacity-7">Jabatan</th>
          <th class="text-center text-secondary text-xs font-weight-semibold opacity-7">Status</th>
          <th class="text-center text-secondary text-xs font-weight-semibold opacity-7">Awal bekerja</th>
        </tr>
      </thead>
      <tbody>
        <!-- Baris akan ditambahkan di sini -->
      </tbody>
    </table>

    <!-- Tombol untuk membuka modal -->
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalTambahkanAnggota">
      Tambahkan Anggota
    </button>

    <!-- Modal Tambahkan Anggota -->
    <div class="modal fade" id="modalTambahkanAnggota" tabindex="-1" aria-labelledby="modalTambahkanAnggotaLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalTambahkanAnggotaLabel">Tambahkan Anggota</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            <!-- Formulir untuk Menambahkan Anggota -->
            <form id="formTambahkanAnggota">
              <div class="mb-3">
                <label for="namaAnggota" class="form-label">Nama</label>
                <input type="text" class="form-control" id="namaAnggota" placeholder="Masukkan Nama Anggota" required>
              </div>
              <div class="mb-3">
                <label for="jabatanAnggota" class="form-label">Jabatan</label>
                <input type="text" class="form-control" id="jabatanAnggota" placeholder="Masukkan Jabatan Anggota" required>
              </div>
              <div class="mb-3">
                <label for="fileGambar" class="form-label">Unggah Gambar</label>
                <input type="file" class="form-control" id="fileGambar" accept="image/*">
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
            <button type="button" class="btn btn-primary" id="simpan">Simpan</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

  <script>
    // Fungsi untuk memuat data dari LocalStorage ke tabel
    function loadTableFromLocalStorage() {
      const anggotaData = JSON.parse(localStorage.getItem("anggotaData")) || [];
      const tbody = $("#tabelAnggota tbody");
      tbody.empty(); // Bersihkan tabel

      anggotaData.forEach((anggota) => {
        tbody.append(`
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <img src="${anggota.gambar}" class="avatar avatar-sm rounded-circle me-2" alt="avatar" />
                <div class="d-flex flex-column">
                  <h6 class="mb-0 text-sm">${anggota.nama}</h6>
                  <p class="text-sm text-secondary mb-0">${anggota.email}</p>
                </div>
              </div>
            </td>
            <td>${anggota.jabatan}</td>
            <td class="text-center">Aktif</td>
            <td class="text-center">${anggota.awalBekerja}</td>
          </tr>
        `);
      });
    }

    $(document).ready(function() {
      // Muat data dari LocalStorage saat halaman dimuat
      loadTableFromLocalStorage();

      // Tombol simpan pada modal
      $('#simpan').click(function() {
        // Dapatkan data dari formulir
        const nama = $('#namaAnggota').val();
        const jabatan = $('#jabatanAnggota').val();
        const gambar = URL.createObjectURL($('#fileGambar')[0].files[0]);
        const tanggalSekarang = new Date().toLocaleDateString();

        // Tambahkan baris ke tabel
        $('#tabelAnggota tbody').append(`
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <img src="${gambar}" class="avatar avatar-sm rounded-circle me-2" alt="avatar" />
                <div class="d-flex flex-column">
                  <h6 class="mb-0 text-sm">${nama}</h6>
                  <p class="text-sm text-secondary mb-0">${jabatan}</p>
                </div>
              </div>
            </td>
            <td>${jabatan}</td>
            <td class="text-center">Aktif</td>
            <td class="text-center">${tanggalSekarang}</td>
          </tr>
        `);

        // Simpan data ke LocalStorage
        const anggotaData = JSON.parse(localStorage.getItem("anggotaData")) || [];
        anggotaData.push({
          nama,
          jabatan,
          gambar,
          awalBekerja: tanggalSekarang,
        });
        localStorage.setItem("anggotaData", JSON.stringify(anggotaData));

        // Bersihkan formulir setelah disimpan
        $('#formTambahkanAnggota')[0].reset();

        // Tutup modal
        $('#modalTambahkanAnggota').modal('hide');
      });
    });
  </script>
</body>
</html>
